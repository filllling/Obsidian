# 思路
- 本方法将多标签句子分类设定为子任务（Stage I），将文档匹配作为主任务（Stage II）。
### 🧩 **Stage I：多标签句子分类（子任务）**

### 🎯 目标
- 学习一个**多标签句子分类器**，预测每个句子的类别向量分量，得到**显式知识表示**$e_k$​，其值在 0 到 1 之间。
### 📘 数据集表示
   -  给定一个句子级标注数据集：$S = \{(s_i, \gamma_i)\}_{i=1}^N$
   -  其中：$s_i = \{t_1, t_2, ..., t_i, ...\}$表示一个**finite length token  sequence of a sentence***
   -  $\gamma_i$为句子的类别向量，对应标签集：$L = \{l_1, l_2, ..., l_L\}$
   -  若句子 $s_i$  属于类别 $l_k$，则：$\gamma_{i,k} = 1$否则为：$\gamma_{i,k} = 0$ 


#### 🧠 具体流程
1. **句子特征向量提取：**
    $e_c = \text{Extractor}(s)$
2. **显式知识：**
    $e_k = \text{Sigmoid}(W^{t_1} \cdot e_c + b^{t_1})$
3. **文档表示：**
    $\mathbf{Mc} = [e_{c,1}, e_{c,2}, \ldots, e_{c,\text{len}}]^T$
    $\mathbf{Mk} = [e_{k,1}, e_{k,2}, \ldots, e_{k,\text{len}}]^T$



###  🧩 **Stage II：文档表示与匹配（主任务）**
### ✅ 输入数据
### 🎯 目标
- 根据stage I 提取出的显性知识，获得文档的语义、知识矩阵，通过**知识融合器获得文档d**的最终表示，进而进行文档匹配。 

### 🧠 具体流程

1. **计算查询与库中文档的差异向量**
     对于每个 $d_i \in D$，计算差异向量:
         $v_{q-i} = d_q - d_i$
2. **聚合差异向量**
     将所有差异向量取平均：
          $v_D = \frac{1}{M} \sum_{i=1}^{M} v_{q-i}$
3. **匹配度预测**
     将 $v_D$ 输入分类器（Softmax）预测匹配得分 $Y$：
          $Y = \text{Softmax}(W_D v_D)$
4. **决策规则**
     选择得分最高且超过阈值 τ\tauτ 的案例文档作为匹配结果：
         $d_r = \arg\max_{d_i \in D} y_i \quad \text{subject to} \quad y_i \geq \tau$




## Softmax？

- **把数值变成概率**，方便比较谁最大、谁最可能。
- **保留排序关系**，大数对应大概率，小数对应小概率。
- 常用于**多分类任务**的最后一层，比如文本分类、图像识别。

比如：  
输入模型最后一层得到一个向量 $(2,1,0.1)$，直接看不出啥意思。  
经过Softmax处理后，可能变成 $(0.65,0.25,0.10)$就可以理解成：

- 类别1的概率是 65%
- 类别2是 25%
- 类别3是 10%









![[Pasted image 20250425235459.png]]

